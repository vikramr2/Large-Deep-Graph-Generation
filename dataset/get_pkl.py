# -*- coding: utf-8 -*-
"""get pkl.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1e7bezJ2-IXi6V_eLGUjPlL5hC3CygSN0
"""

from google.colab import drive
drive.mount('/content/drive')

import os
import pickle
import networkx as nx

folder_path = "/content/drive/MyDrive/amazon"

graphs = []

for file_name in sorted(os.listdir(folder_path)):
    if file_name.endswith(".tsv"):
        file_path = os.path.join(folder_path, file_name)

        graph = nx.Graph()

        with open(file_path, "r") as file:
            for line in file:
                node1, node2 = map(int, line.strip().split("\t"))
                graph.add_edge(node1, node2)
        graphs.append(graph)

output_path = "/content/drive/MyDrive/amazon.pkl"
with open(output_path, "wb") as pkl_file:
    pickle.dump(graphs, pkl_file)

print(f"Serialized {len(graphs)} graphs to {output_path}")

for i, g in enumerate(graphs[:1]):
    print(f"Graph {i + 1} Info:")
    print("Nodes:")
    print(list(g.nodes(data=True)))
    print("Edges:")
    print(list(g.edges(data=True)))

